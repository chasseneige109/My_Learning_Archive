제시하신 VAE의 두 가지 주요 한계점과 이것이 Normalizing Flow 및 Diffusion Model로 어떻게 이어지는지를 간결하게 정리해 드리겠습니다.

---

### **VAE의 주요 한계와 해결 방향**

#### **1. 한계 ①: Posterior 근사 문제 (The Inference Gap)**

- **VAE의 한계:** VAE는 우리가 모르는 $P(z|x)$ 대신 단순한 형태(주로 가우시안)의 $Q(z|x)$를 사용하는데, 이 근사 때문에 **정확한 $z$를 추론하지 못하는 오차(Inference Gap)**가 발생합니다.
    
- **Normalizing Flow로의 연결:** 만약 데이터의 변환 $z \to x$와 역변환 $x \to z$가 모두 **정확하게 계산 가능(가역적, Invertible)**하도록 모델을 설계한다면, $P(z|x)$를 추론하기 위한 별도의 근사 분포 $Q(z|x)$ 자체가 필요 없게 됩니다. 이 아이디어를 발전시킨 것이 바로 **Normalizing Flow** 모델입니다.

#### **2. 한계 ②: 출력이 "뿌옇다 (Blurry)" 문제**

| **문제**                   | **원인**                                                                            | **해결 아이디어 → 모델**                                                 |
| ------------------------ | --------------------------------------------------------------------------------- | ---------------------------------------------------------------- |
| **샘플 이미지의 품질 저하 (흐릿함).** | 디코더가 **평균적인 이미지**를 생성하는 경향이 있으며, 노이즈를 $\mathcal{N}(0, I)$라는 구조 없는 가우시안으로 가정했기 때문. | **단순한 $P(z)$ Prior를 여러 단계로 점진적으로 복잡하게** 만들어 실제 데이터 분포에 가까워지도록 함. |
| **핵심**                   | $P(z)$ (Prior)가 너무 단순하여, 복잡한 데이터 분포까지 한 번에 도약하기 어려움. $\rightarrow$ 평균적인 해석 초래.    | $\Downarrow$                                                     |
| **다음 모델**                |                                                                                   | **Diffusion Model** (다음 단계 모델)                                   |

VAE는 생성 모델의 중요한 기반을 다졌으나, 위 두 가지 한계를 극복하기 위해 **Normalizing Flow**와 **Diffusion Model**이라는 새로운 방법론이 발전하게 됩니다.